<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pickler">
<title>Getting started • pickler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="pickler">
<meta property="og:image" content="https://mjfrigaard.github.io/pickler/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pickler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/start.html">Getting started</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mjfrigaard/pickler/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mjfrigaard/pickler/blob/HEAD/vignettes/start.Rmd" class="external-link"><code>vignettes/start.Rmd</code></a></small>
      <div class="d-none name"><code>start.Rmd</code></div>
    </div>

    
    
<p>This vignette covers how to use <code>pickler</code> functions with
<a href="https://testthat.r-lib.org/reference/describe.html" class="external-link"><code>testthat</code>’s
<code>describe()</code> and <code>it()</code> functions</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjfrigaard.github.io/pickler/">pickler</a></span><span class="op">)</span></span></code></pre></div>
<p>Make sure you have the latest version of <code>testthat</code>
installed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://pak.r-lib.org/" class="external-link">pak</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span>,</span>
<span>    repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"r-lib/testthat"</span>, upgrade <span class="op">=</span> <span class="cn">TRUE</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p><code>pickler</code> was motivated by the latest recommendation from
the <code>testthat</code> authors on moving the test scope to
<em>within</em> the test (i.e., remove or reduce the need for code
outside the call to <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>).</p>
<p><br></p>
<blockquote>
<p><strong><em>To avoid code outside of
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>:</em></strong></p>
<ul>
<li><p><strong><em>Move file-scope logic to either narrower scope (just
this test) or a broader scope (all files)</em></strong></p></li>
<li><p><strong><em>It’s ok to copy and paste: test code doesn’t have to
be super dry. Obvious &gt;&gt; DRY</em></strong> - <a href="https://github.com/posit-conf-2023/pkg-dev-masterclass/blob/main/materials/3-advanced-testing.pdf" class="external-link">Package
Development Masterclass, posit::conf(2023)</a></p></li>
</ul>
</blockquote>
<p><br></p>
<p>Adopting test <a href="https://www.tidyverse.org/blog/2020/04/self-cleaning-test-fixtures/" class="external-link">fixtures,
helpers, and setup</a> files will address the first item in the list
above, but <code>pickler</code> is mostly focused on the second item:
making tests obvious and clear.</p>
</div>
<div class="section level2">
<h2 id="behavior-driven-development-functions">Behavior-driven development functions<a class="anchor" aria-label="anchor" href="#behavior-driven-development-functions"></a>
</h2>
<p>The behavior-driven development (BDD) <a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">functions</a>
are excellent additions to the suite of testing tools provided by
<code>testthat</code>. They work like so:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span>description <span class="op">=</span> <span class="st">"verify that you implement the right things"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span>description <span class="op">=</span> <span class="st">"ensure you do the things right"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
<p>The great thing about <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> is that they can be
<em>nested</em>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span>description <span class="op">=</span> <span class="st">"decribe the right way to implement thing"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span>description <span class="op">=</span> <span class="st">"verify that you implemented the right thing"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span>description <span class="op">=</span> <span class="st">"ensure you do the thing right"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
<p>Each <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code> call is essentially identical to
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>, but allows for a longer character string
<code>description</code>.</p>
</div>
<div class="section level2">
<h2 id="what-to-test">What to test<a class="anchor" aria-label="anchor" href="#what-to-test"></a>
</h2>
<p><br></p>
<blockquote>
<p><strong><em>Strive to test each behaviour in one and only one test.
Then if that behaviour later changes you only need to update a single
test</em></strong> - <a href="https://r-pkgs.org/testing-design.html#what-to-test" class="external-link">What to test,
R Packages, 2ed</a></p>
</blockquote>
<p><br></p>
<p><code>pickler</code> attempts to address the advice above by
providing a set of <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin-style
syntax</a> functions that can be placed in the <code>description</code>
argument of <code>decribe()</code> or <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code>. The three
primary functions in <code>pickler</code> are <code><a href="../reference/feature.html">feature()</a></code>,
<code><a href="../reference/scenario.html">scenario()</a></code>, and <code><a href="../reference/background.html">background()</a></code>.</p>
<p>The following sections walk through an example with the
<code><a href="../reference/split_cols.html">split_cols()</a></code> function. You can view the source code for
this function <a href="https://github.com/mjfrigaard/pickler/blob/main/R/split_cols.R" class="external-link">here</a>,
but for now we’ll just look it’s arguments and the problem it
solves:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/split_cols.html">split_cols</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>, </span>
<span>  <span class="va">col</span>, </span>
<span>  pattern <span class="op">=</span> <span class="st">"[^[:alnum:]]+"</span>, </span>
<span>  col_prefix <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span></span></code></pre></div>
<p>Given the <code>input_data</code> data below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_data</span></span>
<span><span class="co">#&gt;   id                name</span></span>
<span><span class="co">#&gt; 1  1               First</span></span>
<span><span class="co">#&gt; 2  2         First, Last</span></span>
<span><span class="co">#&gt; 3  3 First, Middle, Last</span></span></code></pre></div>
<p><code><a href="../reference/split_cols.html">split_cols()</a></code> will generate this:</p>
<pre><code><span><span class="co">#&gt;   id                name col_1  col_2 col_3</span></span>
<span><span class="co">#&gt; 1  1               First First   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2  2         First, Last First   Last  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3  3 First, Middle, Last First Middle  Last</span></span></code></pre>
<p><code><a href="../reference/split_cols.html">split_cols()</a></code> was written because <a href="https://tidyr.tidyverse.org/reference/index.html#character-vectors" class="external-link"><code>tidyr::separate()</code></a>
didn’t have an easy solution, and I wanted to reduce the number of
keystrokes/neurons/dependencies/etc to solve this problem.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu">separate</span><span class="op">(</span>data <span class="op">=</span> <span class="va">input_data</span>, </span>
<span>                     col <span class="op">=</span> <span class="st">"name"</span>, </span>
<span>                     into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col_1"</span>, <span class="st">"col_2"</span>, <span class="st">"col_3"</span><span class="op">)</span>, </span>
<span>                     remove <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     extra <span class="op">=</span> <span class="st">"merge"</span>, </span>
<span>                     fill <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>#&gt;   id                name col_1  col_2 col_3</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>#&gt; 1  1               First First   &lt;NA&gt;  &lt;NA&gt;</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>#&gt; 2  2         First, Last First   Last  &lt;NA&gt;</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>#&gt; 3  3 First, Middle, Last First Middle  Last</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<p>Features are the units of functionality we’re trying to deliver. We
can adapt the language from <code>testthat</code>’s BDD functions above
into a <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin-style</a>
feature:</p>
<pre class="gherkin"><code>Feature: My function's feature
  As a user of this function
  I want to verify that I implemented the right thing
  So that I can ensure I did the thing right</code></pre>
<p>Features have the following keywords:</p>
<pre class="gherkin"><code>Feature: &lt;title&gt;
  As a &lt;person using the code&gt;
  I want &lt;some action&gt;
  So that &lt;desired behavior&gt;</code></pre>
<p>A feature should start with a mental model of the problem we’d like
to solve. The <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin-style</a>
example for <code><a href="../reference/split_cols.html">split_cols()</a></code> might look something like
this:</p>
<pre class="gherkin"><code>Feature: Split a single column into multiple columns using a pattern
  As an analyst 
  I want to specify a column and a pattern 
  So that I can quickly generate multiple columns.</code></pre>
<p>The goal of a feature is to clearly state the objective or
functionality we’re trying to achieve. The arguments in
<code><a href="../reference/feature.html">feature()</a></code> match the Gherkin feature keywords:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> ,</span>
<span>    as_a <span class="op">=</span> ,</span>
<span>    i_want <span class="op">=</span> ,</span>
<span>    so_that <span class="op">=</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>This pattern is similar for all <code>pickler</code> functions, but
I’ve converted the keywords to <code>snake_case</code> so they align
with the <a href="https://style.tidyverse.org/syntax.html#object-names" class="external-link"><code>tidyverse</code>
naming conventions</a>).</p>
<p><code>pickler</code>’s function arguments also serve as prompts to
fill out each keyword:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You might be wondering why you’d bother passing this information into
a function and not just include them in a language-agnostic fenced code
block:</p>
<pre class="verbatim"><code>```
Feature: Split a single column into multiple columns using a pattern
  As an analyst 
  I want to specify a column and a pattern 
  So that I can quickly generate multiple columns.
```</code></pre>
<p><code>picker</code>’s functions are designed to work in R Markdown
<em>and</em> <code>testthat</code> tests. For example, any code blocks
with a <code>pickler</code> functions can set to <code>eval=TRUE</code>,
<code>echo=FALSE</code>, and <code>comment=""</code> to render nicely
formatted Gherkin syntax when the file is knitted:</p>
<pre><code>Feature: Split a single column into multiple columns using a pattern
  As a user of split_cols()
  I want to specify a column and a pattern
  So that I can quickly generate multiple columns.</code></pre>
</div>
<div class="section level2">
<h2 id="scenarios">Scenarios<a class="anchor" aria-label="anchor" href="#scenarios"></a>
</h2>
<p>Examples are the cornerstone of behavior-driven development and
testing. Captured as <em>scenarios</em>, these should illustrate a
concrete example of how our code should behave. Scenarios are also great
for communicating and documenting requirements, code, and tests with
stakeholders and non-technical audiences:</p>
<p><br></p>
<blockquote>
<p><strong><em>“Examples play a primary role in BDD, simply because
they’re an extremely effective way of communicating clear, precise, and
unambiguous requirements. Specifications written in natural language
are, as it turns out, a terribly poor way of communicating requirements,
because there’s so much space for ambiguity, assumptions, and
misunderstandings. Examples are a great way to overcome these
limitations and clarify the requirements. Examples are also a great way
to explore and expand your knowledge.”</em></strong> - <a href="https://www.manning.com/books/bdd-in-action" class="external-link">BDD in Action, John
Ferguson Smart</a></p>
</blockquote>
<p><br></p>
<p>Consider the <code><a href="../reference/scenario.html">scenario()</a></code> below for
<code><a href="../reference/split_cols.html">split_cols()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe with a specified column"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the column using the default pattern"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"the column should be split into multiple columns"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We could also add function arguments (in square brackets), but this
is optional.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"the [col] column should be split into multiple columns"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>When rendered, this scenario would look like so:</p>
<pre><code>Scenario: Split column with a default pattern
  Given a dataframe [data] with a specified column [col]
  When I split the [col] column using the default [[^[:alnum:]]+]
  Then the [col] column should be split into multiple columns</code></pre>
<div class="section level3">
<h3 id="and">And<a class="anchor" aria-label="anchor" href="#and"></a>
</h3>
<p>Scenarios can also include additional <code>and</code> statements
after the <code>then</code> keyword to test multiple behaviors:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"the [col] column should be split into multiple columns"</span>,</span>
<span>    and <span class="op">=</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Gherkin scenarios occasionally include <code>And</code> keywords
directly following a <code>Given</code> statement, but in
<code>pickler</code> this information is placed in the
<code><a href="../reference/background.html">background()</a></code>:</p>
</div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p><code><a href="../reference/background.html">background()</a></code> can be used to provide context for any
preexisting conditions (or the state of the world) we’re contending
with. <code><a href="../reference/background.html">background()</a></code> can also be used to reduce any
repetitive information in scenarios. For example, consider the two
scenarios below:</p>
<pre class="gherkin"><code>  Scenario: Split column with 'default' pattern
    Given a dataframe with text data
    And a specified column "&lt;column_name&gt;"
    When I split the column with the default pattern
    And a column prefix "&lt;col_prefix&gt;"
    Then the column should be split into multiple columns
    And the resulting dataframe should have the original data with added split columns
    And the new columns should have names with the provided prefix and an index

  Scenario: Split column with 'custom' pattern
    Given a dataframe with text data
    And a specified column "&lt;column_name&gt;"
    When I split the column with a custom pattern "&lt;pattern&gt;"
    And a column prefix "&lt;col_prefix&gt;"
    Then the column should be split according to the custom pattern
    And the resulting dataframe should have the original data with added split columns
    And the new columns should have names with the provided prefix and an index</code></pre>
<p>These scenarios have a lot of duplicated lines–specifically, these
three:</p>
<pre class="gherkin"><code>Given a dataframe with text data
And a specified column "&lt;column_name&gt;"
And a column prefix "&lt;col_prefix&gt;"</code></pre>
<p>We can place these in a <code><a href="../reference/background.html">background()</a></code> to remove
repetition and ‘set the stage’ for any future scenarios:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span>               <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The nice thing about storing additional context in
<code><a href="../reference/background.html">background()</a></code> is that you’ll only have to update this
information in a single location.</p>
<p>When rendered, the <code><a href="../reference/background.html">background()</a></code> looks like this:</p>
<pre><code>Background: Input dataframe with text data
  Given a dataframe [data] with text columns
  And a column prefix [cols_]
  And a specified column [col]
    </code></pre>
</div>
<div class="section level2">
<h2 id="tests">Tests<a class="anchor" aria-label="anchor" href="#tests"></a>
</h2>
<p>BDD tests are written to communicate the context, intended behavior,
and a series of use cases for how our code should be used.
<code>pickler</code> functions help facilitate this because they can be
placed in nested calls to <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> and
<code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code>.</p>
<p>Below is an example <code><a href="../reference/feature.html">feature()</a></code>,
<code><a href="../reference/background.html">background()</a></code>, and <code><a href="../reference/scenario.html">scenario()</a></code> for
<code><a href="../reference/split_cols.html">split_cols()</a></code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>        given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>        and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   <span class="st">"a column prefix [cols_]"</span>, </span>
<span>                   <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>        given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>        when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>        then <span class="op">=</span> <span class="st">"the [col] column should be split into multiple columns"</span></span>
<span>      <span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
<p>BDD tests take longer to write, but the tradeoff is obvious: any
losses in brevity are gained in clarity. The emphasis on using plain
language makes it easier for stakeholders and collaborators to
understand how our code works (and how it’s being tested).</p>
<p><code>pickler</code> functions can also be placed in
<code>desc</code> argument of a the <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> test, but
sometimes a multiline descriptions <a href="https://github.com/r-lib/testthat/issues/1900#issue-1995181567" class="external-link">can
cause errors</a>.:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"My function's feature"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of this function"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to verify that I implemented the right thing"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"to ensure I did the thing right"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  code <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bundling">Bundling<a class="anchor" aria-label="anchor" href="#bundling"></a>
</h2>
<p>Ideally, <code>pickler</code>’s functions are developed independently
and then wrapped in a <code><a href="../reference/bundle.html">bundle()</a></code> before passing to the
<code>testthat</code> BDD functions:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span>               <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Bundling makes it easier to combine features and backgrounds into a
single call:</p>
<pre><code>Feature: Split a single column into multiple columns using a pattern
  As a user of split_cols()
  I want to specify a column and a pattern
  So that I can quickly generate multiple columns.
Background: Input dataframe with text data
  Given a dataframe [data] with text columns
  And a column prefix [cols_]
  And a specified column [col]
    </code></pre>
<p><code><a href="../reference/bundle.html">bundle()</a></code> also allows us to pass a <code><a href="../reference/feature.html">feature()</a></code>
and <code><a href="../reference/background.html">background()</a></code> to <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code>, then test a
particular <code><a href="../reference/scenario.html">scenario()</a></code> with <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span></span>
<span>  <span class="co"># bundle feature and background</span></span>
<span>  <span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span>               <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span></span>
<span>    <span class="co"># test scenario 1</span></span>
<span>     <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>        given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>        when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>        then <span class="op">=</span> <span class="st">"the [col] column should be split into multiple columns"</span></span>
<span>      <span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span></span>
<span>    <span class="co"># test scenario 2</span></span>
<span>     <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>        given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>        when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>        then <span class="op">=</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span>      <span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed </span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<p>It’s also possible to provide a table in a scenario or feature. Let’s
assume we have a small example of data that illustrates an example
behavior for our <code><a href="../reference/split_cols.html">split_cols()</a></code> function (stored in
<code>input</code>):</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span></span>
<span><span class="co">#&gt;   value                      name</span></span>
<span><span class="co">#&gt; 1     1                      John</span></span>
<span><span class="co">#&gt; 2     2               John, Jacob</span></span>
<span><span class="co">#&gt; 3     3 John, Jacob, Jingleheimer</span></span></code></pre></div>
<p>We can convert <code>input</code> to a Gherkin-style table using
<code><a href="../reference/with_table.html">with_table()</a></code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_table.html">with_table</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span></span></code></pre></div>
<pre><code>|value |name                      |
|------|--------------------------|
|1     |John                      |
|2     |John, Jacob               |
|3     |John, Jacob, Jingleheimer |</code></pre>
<p><code><a href="../reference/with_table.html">with_table()</a></code> creates a slightly modified
<code>knitr::kable(format = "pipe", align = "l")</code> table we can
include in a <code><a href="../reference/bundle.html">bundle()</a></code> with the <code>background</code> and
<code>feature</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [name]"</span>, </span>
<span>               <span class="st">"a specified column [name]"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  </span>
<span>  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">           |value |name                      |</span></span>
<span><span class="st">           |------|--------------------------|</span></span>
<span><span class="st">           |1     |John                      |</span></span>
<span><span class="st">           |2     |John, Jacob               |</span></span>
<span><span class="st">           |3     |John, Jacob, Jingleheimer |</span></span>
<span><span class="st">           "</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This makes it easier to view them in RMarkdown or Quarto files (with
<code>echo</code> set to <code>FALSE</code> and <code>comment</code> set
to <code>""</code>)</p>
<pre><code>Feature: Split a single column into multiple columns using a pattern
  As a user of split_cols()
  I want to specify a column and a pattern
  So that I can quickly generate multiple columns.
Background: Input dataframe with text data
  Given a dataframe [data] with text columns
  And a column prefix [default]
  And a specified column [name]
    

           |value |name                      |
           |------|--------------------------|
           |1     |John                      |
           |2     |John, Jacob               |
           |3     |John, Jacob, Jingleheimer |
           </code></pre>
<p>If we know we know what we the <code>output</code> table should look
like, we can include it with the <code>scenario</code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_table.html">with_table</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre></div>
<pre><code>|value |name                      |col_1 |col_2 |col_3        |
|------|--------------------------|------|------|-------------|
|1     |John                      |John  |NA    |NA           |
|2     |John, Jacob               |John  |Jacob |NA           |
|3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [name]"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the [name] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"Then the [name] column should be split into multiple columns"</span>,</span>
<span>    and <span class="op">=</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span>  <span class="op">)</span>,</span>
<span>output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="st">"</span></span>
<span><span class="st">          |value |name                      |col_1 |col_2 |col_3        |</span></span>
<span><span class="st">          |------|--------------------------|------|------|-------------|</span></span>
<span><span class="st">          |1     |John                      |John  |NA    |NA           |</span></span>
<span><span class="st">          |2     |John, Jacob               |John  |Jacob |NA           |</span></span>
<span><span class="st">          |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |</span></span>
<span><span class="st">          "</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now our <code>background</code>, <code>feature</code>,
<code>scenario</code> (and tables) are in the Gherkin-style format that
can be placed in a R Markdown file and nicely rendered for stakeholders
or non-technical audiences:</p>
<pre><code>Feature: Split a single column into multiple columns using a pattern
  As a user of split_cols()
  I want to specify a column and a pattern
  So that I can quickly generate multiple columns.
Background: Input dataframe with text data
  Given a dataframe [data] with text columns
  And a column prefix [default]
  And a specified column [name]
    

           |value |name                      |
           |------|--------------------------|
           |1     |John                      |
           |2     |John, Jacob               |
           |3     |John, Jacob, Jingleheimer |
           
Scenario: Split column with a default pattern
  Given a dataframe [data] with a specified column [name]
  When I split the [name] column using the default [[^[:alnum:]]+]
  Then the [name] column should be split into multiple columns
  And the new columns should be named with the default prefix [cols_]

          |value |name                      |col_1 |col_2 |col_3        |
          |------|--------------------------|------|------|-------------|
          |1     |John                      |John  |NA    |NA           |
          |2     |John, Jacob               |John  |Jacob |NA           |
          |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |
          </code></pre>
<p>And our test file contains a fully scoped test with everything
documented:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [default]"</span>, </span>
<span>               <span class="st">"a specified column [name]"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  </span>
<span>  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">           |value |name                      |</span></span>
<span><span class="st">           |------|--------------------------|</span></span>
<span><span class="st">           |1     |John                      |</span></span>
<span><span class="st">           |2     |John, Jacob               |</span></span>
<span><span class="st">           |3     |John, Jacob, Jingleheimer |</span></span>
<span><span class="st">           "</span><span class="op">)</span><span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>    </span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span></span>
<span> <span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>      given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [name]"</span>,</span>
<span>      when <span class="op">=</span> <span class="st">"I split the [name] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>      then <span class="op">=</span> <span class="st">"the [name] column should be split into multiple columns"</span>,</span>
<span>      and <span class="op">=</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span>  <span class="op">)</span>,</span>
<span>output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">          |value |name                      |col_1 |col_2 |col_3        |</span></span>
<span><span class="st">          |------|--------------------------|------|------|-------------|</span></span>
<span><span class="st">          |1     |John                      |John  |NA    |NA           |</span></span>
<span><span class="st">          |2     |John, Jacob               |John  |Jacob |NA           |</span></span>
<span><span class="st">          |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |</span></span>
<span><span class="st">        "</span><span class="op">)</span></span>
<span>  <span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># create observed output</span></span>
<span>  <span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/split_cols.html">split_cols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">input</span>, col <span class="op">=</span> <span class="st">'name'</span><span class="op">)</span></span>
<span>  <span class="co"># compare against output</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">observed</span>, expected <span class="op">=</span> <span class="va">output</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
<p>And when it’s placed in the <a href="https://github.com/mjfrigaard/pickler/blob/main/tests/testthat/test-split_cols.R" class="external-link">test
file</a>, it passes!</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">:::</span><span class="fu">test_active_file</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>[ FAIL 0 | WARN 0 | SKIP 0 | PASS 1 ]</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Frigaard.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
