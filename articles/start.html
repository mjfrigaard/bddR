<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bddR">
<title>Getting started • bddR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="bddR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bddR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/start.html">Getting started</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started</h1>
            
      
      
      <div class="d-none name"><code>start.Rmd</code></div>
    </div>

    
    
<p>This vignette covers how to use <code>bddR</code> functions with <a href="https://testthat.r-lib.org/reference/describe.html" class="external-link"><code>testthat</code>’s
<code>describe()</code> and <code>it()</code> functions</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjfrigaard.github.io/bddR/">bddR</a></span><span class="op">)</span></span></code></pre></div>
<p>Make sure you have the latest version of <code>testthat</code>
installed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://pak.r-lib.org/" class="external-link">pak</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span>,</span>
<span>    repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"r-lib/testthat"</span>, upgrade <span class="op">=</span> <span class="cn">TRUE</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p><code>bddR</code> was motivated by the latest recommendation from the
<code>testthat</code> authors on moving the test scope to
<em>within</em> the test (i.e., remove or reduce the need for code
outside the call to <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>).</p>
<p><br></p>
<blockquote>
<p><strong><em>To avoid code outside of
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>:</em></strong></p>
<ul>
<li><p><strong><em>Move file-scope logic to either narrower scope (just
this test) or a broader scope (all files)</em></strong></p></li>
<li><p><strong><em>It’s ok to copy and paste: test code doesn’t have to
be super dry. Obvious &gt;&gt; DRY</em></strong> - <a href="https://github.com/posit-conf-2023/pkg-dev-masterclass/blob/main/materials/3-advanced-testing.pdf" class="external-link">Package
Development Masterclass, posit::conf(2023)</a></p></li>
</ul>
</blockquote>
<p><br></p>
<p>Adopting test <a href="https://www.tidyverse.org/blog/2020/04/self-cleaning-test-fixtures/" class="external-link">fixtures,
helpers, and setup</a> files will address the first item in the list
above, but <code>bddR</code> is mostly focused on the second item:
making tests obvious and clear.</p>
</div>
<div class="section level2">
<h2 id="behavior-driven-development-functions">Behavior-driven development functions<a class="anchor" aria-label="anchor" href="#behavior-driven-development-functions"></a>
</h2>
<p>The behavior-driven development (BDD) <a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">functions</a>
are excellent additions to the suite of testing tools provided by
<code>testthat</code>. They work like so:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(<span class="at">description =</span> <span class="st">"verify that you implement the right things"</span>, <span class="at">code =</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">it</span>(<span class="at">description =</span> <span class="st">"ensure you do the things right"</span>, <span class="at">code =</span> {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expect_true</span>(<span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  Test passed</span></code></pre></div>
<p>The great thing about <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> is that they can be
<em>nested</em>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(<span class="at">description =</span> <span class="st">"decribe the right way to implement thing"</span>, <span class="at">code =</span> {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">describe</span>(<span class="at">description =</span> <span class="st">"verify that you implemented the right thing"</span>, <span class="at">code =</span> {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">it</span>(<span class="at">description =</span> <span class="st">"ensure you do the thing right"</span>, <span class="at">code =</span> {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expect_true</span>(<span class="cn">TRUE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  Test passed</span></code></pre></div>
<p>Each <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code> call is essentially identical to
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>, but allows for a longer character string
<code>description</code>.</p>
</div>
<div class="section level2">
<h2 id="what-to-test">What to test<a class="anchor" aria-label="anchor" href="#what-to-test"></a>
</h2>
<p><br></p>
<blockquote>
<p><strong><em>Strive to test each behaviour in one and only one test.
Then if that behaviour later changes you only need to update a single
test</em></strong> - <a href="https://r-pkgs.org/testing-design.html#what-to-test" class="external-link">What to test,
R Packages, 2ed</a></p>
</blockquote>
<p><br></p>
<p><code>bddR</code> attempts to address the advice above by providing a
set of <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin-style
syntax</a> functions that can be placed in the <code>description</code>
argument of <code>decribe()</code> or <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code>. The three
primary functions in <code>bddR</code> are <code><a href="../reference/feature.html">feature()</a></code>,
<code><a href="../reference/scenario.html">scenario()</a></code>, and <code><a href="../reference/background.html">background()</a></code>.</p>
<p>The following sections walk through an example with the
<code><a href="../reference/split_cols.html">split_cols()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_cols</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">col</span>, <span class="va">pattern</span> <span class="op">=</span> <span class="st">"[^[:alnum:]]+"</span>, <span class="va">col_prefix</span> <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"data must be a data.frame or tibble"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">is.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"'col' must be a character"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"'col' must be a column in 'data'"</span> <span class="op">=</span> <span class="va">col</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"'pattern' must be a character"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"col_prefix must be a character"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">col_prefix</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">in_rgx</span> <span class="op">&lt;-</span> <span class="va">pattern</span></span>
<span>  <span class="va">in_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">in_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">split_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">in_data</span><span class="op">[[</span><span class="va">in_col</span><span class="op">]</span><span class="op">]</span>, <span class="va">in_rgx</span><span class="op">)</span></span>
<span>  <span class="va">max_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">split_data</span>, <span class="va">length</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">padded_split_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">split_data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">max_length</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">padded_split_data</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">out_cols</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">col_prefix</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">max_length</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span>  <span class="va">out_cols_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out_cols</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">in_data</span>, <span class="va">out_cols_df</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<p>A feature is an independent unit or functionality in a system. All <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin</a> features
have the following keywords:</p>
<pre class="gherkin"><code>Feature: &lt;title&gt;
  As a &lt;person using the code&gt;
  I want &lt;some action&gt;
  So that &lt;desired behavior&gt;</code></pre>
<p>Using the language from <code>testthat</code>’s BDD functions above,
a feature would be described like so:</p>
<pre class="gherkin"><code>Feature: My function's feature
  As a user of this function
  I want to verify that I implemented the right thing
  So that I can ensure I did the thing right</code></pre>
<p>The <code><a href="../reference/split_cols.html">split_cols()</a></code> function was written because the <a href="https://tidyr.tidyverse.org/reference/index.html#character-vectors" class="external-link"><code>tidyr::separate_*()</code></a>
functions didn’t quite give me the solution I was looking for on a
previous project.</p>
<p>If I were to write the purpose of the <code><a href="../reference/split_cols.html">split_cols()</a></code> in <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin syntax</a>,
it would look something like this:</p>
<pre class="gherkin"><code>Feature: Split a single column into multiple columns using a pattern
  As a user of split_cols()
  I want to specify a column and a pattern 
  So that I can quickly generate multiple columns.</code></pre>
<p>The goal of a feature is to clearly capture the behavior or outcome
we are trying to achieve.</p>
<p>The arguments in the <code><a href="../reference/feature.html">feature()</a></code> function match the
Gherkin feature keywords:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> ,</span>
<span>    as_a <span class="op">=</span> ,</span>
<span>    i_want <span class="op">=</span> ,</span>
<span>    so_that <span class="op">=</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>This pattern is similar for all <code>bddR</code> functions (except
the keywords have been converted to <code>snake_case</code> to align
with the <a href="https://style.tidyverse.org/syntax.html#object-names" class="external-link"><code>tidyverse</code>
naming conventions</a>).</p>
<p>The arguments also serve as prompts to fill out each keyword:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>In R Markdown, code blocks with <code>bddR</code> functions can set
to <code>eval=TRUE</code> and <code>echo=FALSE</code> so the Gherkin
syntax is rendered when the file is knitted:</p>
<pre><code>  Feature: Split a single column into multiple columns using a pattern
    As a user of split_cols()
    I want to specify a column and a pattern
    So that I can quickly generate multiple columns.</code></pre>
</div>
<div class="section level2">
<h2 id="scenarios">Scenarios<a class="anchor" aria-label="anchor" href="#scenarios"></a>
</h2>
<p>Scenarios are at the heart of BDD because they illustrate concrete
examples of how the code in our package should behave. Scenarios are
also great for communicating and documenting requirements, code, and
tests in succinct, plain language:</p>
<p><br></p>
<blockquote>
<p><strong><em>“Examples play a primary role in BDD, simply because
they’re an extremely effective way of communicating clear, precise, and
unambiguous requirements. Specifications written in natural language
are, as it turns out, a terribly poor way of communicating requirements,
because there’s so much space for ambiguity, assumptions, and
misunderstandings. Examples are a great way to overcome these
limitations and clarify the requirements. Examples are also a great way
to explore and expand your knowledge.”</em></strong> - <a href="https://www.manning.com/books/bdd-in-action" class="external-link">BDD in Action, John
Ferguson Smart</a></p>
</blockquote>
<p><br></p>
<p>Consider the scenario below for <code><a href="../reference/split_cols.html">split_cols()</a></code>:</p>
<pre class="gherkin"><code>  Scenario: Split column with a default pattern
    Givena a dataframe with a specified column 
    When I split the column using the default pattern
    Then the column should be split into multiple columns</code></pre>
<p>If we were to re-write this using the <code><a href="../reference/scenario.html">scenario()</a></code>
function, it might look like so:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"the [col] column should be split into multiple columns"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Note that I’ve added the function arguments in square brackets (this
is optional). When rendered, scenarios look like so:</p>
<pre><code>  Scenario: Split column with a default pattern
    Given a dataframe [data] with a specified column [col]
    When I split the [col] column using the default [[^[:alnum:]]+]
    Then the [col] column should be split into multiple columns</code></pre>
<div class="section level3">
<h3 id="and">And<a class="anchor" aria-label="anchor" href="#and"></a>
</h3>
<p>Scenarios can also include additional <code>and</code> statements
after the <code>then</code> keyword to test multiple behaviors:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"the [col] column should be split into multiple columns"</span>,</span>
<span>    and <span class="op">=</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>In Gherkin you’ll occasionally see <code>And</code> keywords
following the <code>Given</code> statement, but in <code>bddR</code>
these are intended to be placed in the <code><a href="../reference/background.html">background()</a></code>:</p>
</div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The <code><a href="../reference/background.html">background()</a></code> function is used to provide context on
any preexisting conditions (or state of the world) we’re contending
with. For example, consider the two Gherkin scenarios below:</p>
<pre class="gherkin"><code>  Scenario: Split column with 'default' pattern
    Given a dataframe with text data
    And a specified column "&lt;column_name&gt;"
    When I split the column with the default pattern
    And a column prefix "&lt;col_prefix&gt;"
    Then the column should be split into multiple columns
    And the resulting dataframe should have the original data with added split columns
    And the new columns should have names with the provided prefix and an index

  Scenario: Split column with 'custom' pattern
    Given a dataframe with text data
    And a specified column "&lt;column_name&gt;"
    When I split the column with a custom pattern "&lt;pattern&gt;"
    And a column prefix "&lt;col_prefix&gt;"
    Then the column should be split according to the custom pattern
    And the resulting dataframe should have the original data with added split columns
    And the new columns should have names with the provided prefix and an index</code></pre>
<p>These scenarios have a lot of repetition–specifically, these
lines:</p>
<pre class="gherkin"><code>Given a dataframe with text data
And a specified column "&lt;column_name&gt;"
And a column prefix "&lt;col_prefix&gt;"</code></pre>
<p>These <code>And</code> statements can be placed in the
<code><a href="../reference/background.html">background()</a></code> to remove repetition:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span>               <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The nice thing about storing context in <code><a href="../reference/background.html">background()</a></code> is
that you’ll only have to update your test context in a single
location.</p>
<p>When rendered, the <code><a href="../reference/background.html">background()</a></code> looks like this:</p>
<pre><code>  Background: Input dataframe with text data
    Given a dataframe [data] with text columns
    And a column prefix [cols_]
    And a specified column [col]
        </code></pre>
<p>BDD tests should communicate the context and intended behaviors, and
provide a series of worked examples for how the code should be used. BDD
tests take longer to write, but they makes it easier for stakeholders
and collaborators to understand how the code in your package should be
used (and tested).</p>
</div>
<div class="section level2">
<h2 id="tests">Tests<a class="anchor" aria-label="anchor" href="#tests"></a>
</h2>
<p><code>bddR</code> functions can be placed in desc argument of a the
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> test, but sometimes a multiline descriptions <a href="https://github.com/r-lib/testthat/issues/1900#issue-1995181567" class="external-link">can
cause errors</a>.:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">feature</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"My function's feature"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_a =</span> <span class="st">"user of this function"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">i_want =</span> <span class="st">"to verify that I implemented the right thing"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">so_that =</span> <span class="st">"to ensure I did the thing right"</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> {</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expect_true</span>(<span class="cn">TRUE</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  Test passed</span></code></pre></div>
<p>It clearer to use nested <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> and
<code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code> calls, because they can hold combinations of features,
scenarios, or backgrounds. Below is an example feature(),
<code><a href="../reference/background.html">background()</a></code>, and <code><a href="../reference/scenario.html">scenario()</a></code> for
<code><a href="../reference/split_cols.html">split_cols()</a></code></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">feature</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_a =</span> <span class="st">"user of split_cols()"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">i_want =</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">so_that =</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">code =</span> {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">describe</span>(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">background</span>(</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">given =</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">and =</span> <span class="fu">list</span>(</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"a column prefix [cols_]"</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"a specified column [col]"</span>)), <span class="at">code =</span> {</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">it</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scenario</span>(</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">given =</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">when =</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">then =</span> <span class="st">"Then the [col] column should be split into multiple columns"</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>      ), <span class="at">code =</span> {</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expect_true</span>(<span class="cn">TRUE</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  Test passed</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bundling">Bundling<a class="anchor" aria-label="anchor" href="#bundling"></a>
</h2>
<p>Ideally, <code>bddR</code>’s functions are developed independently
and then wrapped in a <code><a href="../reference/bundle.html">bundle()</a></code> before passing to the
<code>testthat</code> BDD functions:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span>               <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Bundling makes it easier to combine features and backgrounds into a
single call:</p>
<pre><code>  Feature: Split a single column into multiple columns using a pattern
    As a user of split_cols()
    I want to specify a column and a pattern
    So that I can quickly generate multiple columns.
  Background: Input dataframe with text data
    Given a dataframe [data] with text columns
    And a column prefix [cols_]
    And a specified column [col]
        </code></pre>
<p><code><a href="../reference/bundle.html">bundle()</a></code> also allows us to pass a <code><a href="../reference/feature.html">feature()</a></code>
and <code><a href="../reference/background.html">background()</a></code> to <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code>, then test a
particular <code><a href="../reference/scenario.html">scenario()</a></code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bundle feature and background</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bundle</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">feature</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_a =</span> <span class="st">"user of split_cols()"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">i_want =</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">so_that =</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background</span>(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">given =</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">and =</span> <span class="fu">list</span>(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a specified column [col]"</span>))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>), <span class="at">code =</span> {</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">it</span>(</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># test scenario</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scenario</span>(</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">given =</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">when =</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">then =</span> <span class="st">"Then the [col] column should be split into multiple columns"</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>      ), <span class="at">code =</span> {</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expect_true</span>(<span class="cn">TRUE</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  Test passed</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<p>It’s also possible to provide a table in a scenario or feature. Let’s
assume we have a small example of data that illustrates an example
behavior for our <code><a href="../reference/split_cols.html">split_cols()</a></code> function (stored in
<code>input</code>):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span></span>
<span><span class="co">#&gt;   value                      name</span></span>
<span><span class="co">#&gt; 1     1                      John</span></span>
<span><span class="co">#&gt; 2     2               John, Jacob</span></span>
<span><span class="co">#&gt; 3     3 John, Jacob, Jingleheimer</span></span></code></pre></div>
<p>We can convert <code>input</code> to a Gherkin-style table using
<code><a href="../reference/with_table.html">with_table()</a></code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_table.html">with_table</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span></span>
<span><span class="co">#&gt; |value |name                      |</span></span>
<span><span class="co">#&gt; |------|--------------------------|</span></span>
<span><span class="co">#&gt; |1     |John                      |</span></span>
<span><span class="co">#&gt; |2     |John, Jacob               |</span></span>
<span><span class="co">#&gt; |3     |John, Jacob, Jingleheimer |</span></span></code></pre></div>
<p><code><a href="../reference/with_table.html">with_table()</a></code> creates a slightly modified
<code>knitr::kable(format = "pipe", align = "l")</code> table we can
include in a <code><a href="../reference/bundle.html">bundle()</a></code> with the <code>background</code> and
<code>feature</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/feature.html">feature</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span>    as_a <span class="op">=</span> <span class="st">"user of split_cols()"</span>,</span>
<span>    i_want <span class="op">=</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span>    so_that <span class="op">=</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/background.html">background</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span>    and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span>               <span class="st">"a specified column [col]"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  </span>
<span>  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">           |value |name                      |</span></span>
<span><span class="st">           |------|--------------------------|</span></span>
<span><span class="st">           |1     |John                      |</span></span>
<span><span class="st">           |2     |John, Jacob               |</span></span>
<span><span class="st">           |3     |John, Jacob, Jingleheimer |</span></span>
<span><span class="st">           "</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This makes it easier to view them in RMarkdown or Quarto files (with
<code>echo</code> set to <code>FALSE</code>)</p>
<pre><code>  Feature: Split a single column into multiple columns using a pattern
    As a user of split_cols()
    I want to specify a column and a pattern
    So that I can quickly generate multiple columns.
  Background: Input dataframe with text data
    Given a dataframe [data] with text columns
    And a column prefix [cols_]
    And a specified column [col]
        
  
             |value |name                      |
             |------|--------------------------|
             |1     |John                      |
             |2     |John, Jacob               |
             |3     |John, Jacob, Jingleheimer |
  </code></pre>
<p>If we know we know what we the output table should look like, we can
include it with the <code>scenario</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span></span>
<span><span class="co">#&gt;   value                      name col_1 col_2        col_3</span></span>
<span><span class="co">#&gt; 1     1                      John  John  &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2     2               John, Jacob  John Jacob         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3     3 John, Jacob, Jingleheimer  John Jacob Jingleheimer</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_table.html">with_table</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre></div>
<pre><code>  |value |name                      |col_1 |col_2 |col_3        |
  |------|--------------------------|------|------|-------------|
  |1     |John                      |John  |NA    |NA           |
  |2     |John, Jacob               |John  |Jacob |NA           |
  |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundle.html">bundle</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span>    given <span class="op">=</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span>    when <span class="op">=</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span>    then <span class="op">=</span> <span class="st">"Then the [col] column should be split into multiple columns"</span>,</span>
<span>    and <span class="op">=</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span>  <span class="op">)</span>,</span>
<span>output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">          |value |name                      |col_1 |col_2 |col_3        |</span></span>
<span><span class="st">          |------|--------------------------|------|------|-------------|</span></span>
<span><span class="st">          |1     |John                      |John  |NA    |NA           |</span></span>
<span><span class="st">          |2     |John, Jacob               |John  |Jacob |NA           |</span></span>
<span><span class="st">          |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |</span></span>
<span><span class="st">        "</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now our <code>background</code>, <code>feature</code>,
<code>scenario</code> (and tables) are in the Gherkin-style format that
can be placed in a R Markdown file and nicely rendered for stakeholders
or non-technical audiences:</p>
<pre><code>  Feature: Split a single column into multiple columns using a pattern
    As a user of split_cols()
    I want to specify a column and a pattern
    So that I can quickly generate multiple columns.
  Background: Input dataframe with text data
    Given a dataframe [data] with text columns
    And a column prefix [cols_]
    And a specified column [col]
        
  
             |value |name                      |
             |------|--------------------------|
             |1     |John                      |
             |2     |John, Jacob               |
             |3     |John, Jacob, Jingleheimer |
             
  Scenario: Split column with a default pattern
    Given a dataframe [data] with a specified column [col]
    When I split the [col] column using the default [[^[:alnum:]]+]
    Then Then the [col] column should be split into multiple columns
    And the new columns should be named with the default prefix [cols_]
  
                  |value |name                      |col_1 |col_2 |col_3        |
                  |------|--------------------------|------|------|-------------|
                  |1     |John                      |John  |NA    |NA           |
                  |2     |John, Jacob               |John  |Jacob |NA           |
                  |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |
  </code></pre>
<p>And our test file contains a fully scoped test with everything
documented:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bundle</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">feature</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Split a single column into multiple columns using a pattern"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_a =</span> <span class="st">"user of split_cols()"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">i_want =</span> <span class="st">"to specify a column and a pattern"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">so_that =</span> <span class="st">"I can quickly generate multiple columns."</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Input dataframe with text data"</span>, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">given =</span> <span class="st">"a dataframe [data] with text columns"</span>, </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">and =</span> <span class="fu">list</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a column prefix [cols_]"</span>, </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a specified column [col]"</span>)),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="fu">c</span>(<span class="st">"</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="st">           |value |name                      |</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="st">           |------|--------------------------|</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="st">           |1     |John                      |</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="st">           |2     |John, Jacob               |</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="st">           |3     |John, Jacob, Jingleheimer |</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="st">           "</span>)), <span class="at">code =</span> {</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="fu">it</span>(</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a> <span class="fu">bundle</span>(</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scenario</span>(</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Split column with a default pattern"</span>,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">given =</span> <span class="st">"a dataframe [data] with a specified column [col]"</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">when =</span> <span class="st">"I split the [col] column using the default [[^[:alnum:]]+]"</span>,</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">then =</span> <span class="st">"Then the [col] column should be split into multiple columns"</span>,</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">and =</span> <span class="st">"the new columns should be named with the default prefix [cols_]"</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="at">output =</span> <span class="fu">c</span>(<span class="st">"</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="st">          |value |name                      |col_1 |col_2 |col_3        |</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="st">          |------|--------------------------|------|------|-------------|</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="st">          |1     |John                      |John  |NA    |NA           |</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="st">          |2     |John, Jacob               |John  |Jacob |NA           |</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="st">          |3     |John, Jacob, Jingleheimer |John  |Jacob |Jingleheimer |</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">code =</span> {</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observed output</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">split_cols</span>(<span class="at">data =</span> input, <span class="at">col =</span> <span class="st">'name'</span>)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compare against output</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="at">object =</span> observed, <span class="at">expected =</span> output)</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  Test passed</span></code></pre></div>
<p>And when it’s placed in the <a href="https://github.com/mjfrigaard/bddR/blob/main/tests/testthat/test-split_cols.R" class="external-link">test
file</a>, it passes!</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">:::</span><span class="fu">test_active_file</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>[ FAIL 0 | WARN 0 | SKIP 0 | PASS 1 ]</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Frigaard.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
