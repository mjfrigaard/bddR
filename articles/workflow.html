<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pickler">
<title>Workflow • pickler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Workflow">
<meta property="og:description" content="pickler">
<meta property="og:image" content="https://mjfrigaard.github.io/pickler/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pickler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/start.html">Getting started</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mjfrigaard/pickler/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mjfrigaard/pickler/blob/HEAD/vignettes/workflow.Rmd" class="external-link"><code>vignettes/workflow.Rmd</code></a></small>
      <div class="d-none name"><code>workflow.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjfrigaard.github.io/pickler/">pickler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="test-development-workflow">Test development workflow<a class="anchor" aria-label="anchor" href="#test-development-workflow"></a>
</h2>
<p>In standard R packages, new functionality is added to <code>R/</code>
with <code>usethis::use_r()</code>, followed by a corresponding test
file in <code>tests/testthat/</code> with
<code>usethis::use_test()</code>:</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled checked><code>use_r()</code></p></li>
<li><p><input type="checkbox" disabled checked><code>use_test()</code></p></li>
</ul>
<p>While developing, these files can be accessed using the functions
above, and tested interactively with
<code>devtools::test_active_file()</code> and
<code>devtools::test_coverage_active_file()</code></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled checked><code>test_active_file()</code></p></li>
<li><p><input type="checkbox" disabled checked><code>test_coverage_active_file()</code></p></li>
</ul>
<p>As the code in <code>R/</code> grows, the test suite might include
additional features like fixtures, helpers, mocks, or a
<code>setup.R</code> file. When a package has been sufficiently
developed, the tests are run with <code>devtools::test()</code>, test
coverage is reported with <code>devtools::test_coverage()</code>, and
the (I’m assuming the package is checked periodicaly with
<code>devtools::check()</code>, too):</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled checked><code>test()</code></p></li>
<li><p><input type="checkbox" disabled checked><code>test_coverage()</code></p></li>
</ul>
<p>Additional package can be used to include test coverage reports (<a href="https://yonicd.github.io/covrpage/" class="external-link"><code>covrpage</code></a>),
traceability matrices (<a href="https://genentech.github.io/covtracer/" class="external-link"><code>covtracer</code></a>),
etc., to your package documentation.</p>
<p>Throughout development, the functional requirements for your package
are documented in <code>R/</code> (with <code>roxygen2</code>), and
long-form documentation is placed in vignettes.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The &lt;a href="https://r-pkgs.org/vignettes.html#advice-on-writing-vignettes" class="external-link"&gt;vignettes&lt;/a&gt;
chapter in R Packages, 2ed is a wonderful guide on writing that extends
far beyond R packages.&lt;/p&gt;'><sup>1</sup></a> Vignettes can (and
should) be used to show users how your package works, especially if your
package is going to be shared with the world (i.e., via a <a href="https://pkgdown.r-lib.org/" class="external-link"><code>pkgdown</code> site</a>).
However, it’s not often developers use vignettes to store the
information that’s essential to the development <em>process</em> (i.e.,
proposed features, specficiations, user stories, etc.)</p>
</div>
<div class="section level2">
<h2 id="behavior-driven-development-functions">Behavior-driven development functions<a class="anchor" aria-label="anchor" href="#behavior-driven-development-functions"></a>
</h2>
<p><code>testthat</code>’s BDD functions (specifically
<code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code>) allow us to include additional context for
tests directly preceding the call to <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code> or
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code>. It’s a little unorthodox, but we can compare
the output of passing it() and <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> tests using
<code><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">waldo::compare()</a></code> (the underlying package used in functions
like <code><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal()</a></code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed </span></span>
<span><span class="co">#&gt; Test passed</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> No differences</span></span></code></pre></div>
<p>The ‘secret sauce’ of <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> and <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code>
is the ability to run <code>expect_*()</code> functions and return the
logical (<code>TRUE</code>/pass or <code>FALSE</code>/fail).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>If we attempt to <code><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass()</a></code> the results of a failing
test, we see an error is triggered (and both <code>actual</code> and
<code>expected</code> values e sent off to
<code><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">waldo::compare()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">FALSE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Failure: make sure we did the thing right -----------------------------------</span></span>
<span><span class="co">#&gt; FALSE (`actual`) not equal to TRUE (`expected`).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; `actual`:   FALSE</span></span>
<span><span class="co">#&gt; `expected`: TRUE</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Test failed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">FALSE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Failure: make sure we did the thing right -----------------------------------</span></span>
<span><span class="co">#&gt; FALSE (`actual`) not equal to TRUE (`expected`).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; `actual`:   FALSE</span></span>
<span><span class="co">#&gt; `expected`: TRUE</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Test failed</span></span></code></pre></div>
<p>The <code>TRUE</code>/<code>FALSE</code> result is at the heart of
all unit tests (i.e., “do the results meet my expectations?” Check ‘yes’
or ‘no’).</p>
<p>However, what happens if we wrap the same tests in
<code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code>?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span><span class="st">"verify we implemented the right thing"</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span><span class="st">"verify we implemented the right thing"</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"make sure we did the thing right"</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>We can see <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> returns a <code>NULL</code> value
instead of the logical comparison from <code><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal()</a></code> (but
it still returns the results of the test).</p>
<div class="section level3">
<h3 id="why-should-i-care">Why should I care?<a class="anchor" aria-label="anchor" href="#why-should-i-care"></a>
</h3>
<p>I’ll use a known issue with <code><a href="https://testthat.r-lib.org/reference/expect_snapshot.html" class="external-link">expect_snapshot()</a></code> and
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> to demonstrate how <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code>
saves the day. Assume we have a function that generates output too
complex to test with <code><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pickler_logo.html">pickler_logo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              d8b          888      888</span></span>
<span><span class="co">#&gt;              Y8P          888      888</span></span>
<span><span class="co">#&gt;                           888      888</span></span>
<span><span class="co">#&gt;     88888b.  888  .d8888b 888  888 888  .d88b.  888d888</span></span>
<span><span class="co">#&gt;     888 "88b 888 d88P"    888 .88P 888 d8P  Y8b 888P"</span></span>
<span><span class="co">#&gt;     888  888 888 888      888888K  888 88888888 888</span></span>
<span><span class="co">#&gt;     888 d88P 888 Y88b.    888 "88b 888 Y8b.     888</span></span>
<span><span class="co">#&gt;     88888P"  888  "Y8888P 888  888 888  "Y8888  888</span></span>
<span><span class="co">#&gt;     888</span></span>
<span><span class="co">#&gt;     888</span></span>
<span><span class="co">#&gt;     888</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>We don’t want to visually inspect differences in
<code><a href="../reference/pickler_logo.html">pickler_logo()</a></code>, so we’ll use a snapshot test to capture a
baseline for comparison. Let’s start with <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code></p>
</div>
<div class="section level3">
<h3 id="initial-test_that-snapshot-test">Initial test_that() snapshot test<a class="anchor" aria-label="anchor" href="#initial-test_that-snapshot-test"></a>
</h3>
<p>I’ve included a feature description in the <code>desc</code> argument
for <code><a href="../reference/pickler_logo.html">pickler_logo()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  Feature: Text-based Logo Generation</span></span>
<span><span class="st">  As a As a user who calls the pickler_logo() function</span></span>
<span><span class="st">  I want to generate a text-based logo</span></span>
<span><span class="st">  So that I can quickly insert the pickler logo"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://testthat.r-lib.org/reference/expect_snapshot.html" class="external-link">expect_snapshot</a></span><span class="op">(</span><span class="fu"><a href="../reference/pickler_logo.html">pickler_logo</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test_active_file</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>After the initial call to <code>test_active_file()</code>,
<code>testthat</code> tells us the location of the snapshot file is
<code>tests/testthat/_snaps/</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Feature: Text-based Logo Generation</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  As a As a user who calls the pickler_logo() function</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  I want to generate a text-based logo</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  So that I can quickly insert the pickler logo</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="in">    Code</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="in">      pickler_logo()</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="in">    Output</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="in">                   d8b          888      888</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="in">                   Y8P          888      888</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="in">                                888      888</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="in">          88888b.  888  .d8888b 888  888 888  .d88b.  888d888</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="in">          888 "88b 888 d88P"    888 .88P 888 d8P  Y8b 888P"</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="in">          888  888 888 888      888888K  888 88888888 888</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="in">          888 d88P 888 Y88b.    888 "88b 888 Y8b.     888</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="in">          88888P"  888  "Y8888P 888  888 888  "Y8888  888</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="in">          888</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="in">          888</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="in">          888</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="in">          </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subsequent-test_that-test-runs">Subsequent test_that() test runs<a class="anchor" aria-label="anchor" href="#subsequent-test_that-test-runs"></a>
</h3>
<p>Later we decide to change <code><a href="../reference/pickler_logo.html">pickler_logo()</a></code> by replacing
the <code>\"</code> with <code>'</code>. After loading the changes, we
notice that when we run the test again a <em>new snapshot file</em> is
generated (and updated with the a new version of the logo):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Feature: Text-based Logo Generation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  As a As a user who calls the text_logo() function</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  I want to generate a text-based logo</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  So that I can quickly insert the pickler logo</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="in">    Code</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="in">      pickler_logo()</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="in">    Output</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="in">                   d8b          888      888</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="in">                   Y8P          888      888</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="in">                                888      888</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="in">          88888b.  888  .d8888b 888  888 888  .d88b.  888d888</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="in">          888 '88b 888 d88P'    888 .88P 888 d8P  Y8b 888P'</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="in">          888  888 888 888      888888K  888 88888888 888</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="in">          888 d88P 888 Y88b.    888 '88b 888 Y8b.     888</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="in">          88888P'  888  'Y8888P 888  888 888  'Y8888  888</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="in">          888</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="in">          888</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="in">          888</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="in">          </span></span></code></pre></div>
<p>However, if the contents of <code>desc</code> are placed in the
<code>description</code> argument of <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code>, we see
<code>testthat</code> detects the changes and asks us to review the
snapshots.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This currently &lt;a href="https://github.com/r-lib/testthat/issues/1900#issue-1995181567" class="external-link"&gt;an
open issue on GitHub&lt;/a&gt;, but it looks like this &lt;a href="https://github.com/mjfrigaard/shinyap/issues/18#issuecomment-1816626915" class="external-link"&gt;can
be solved with &lt;code&gt;paste()&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span></span>
<span>  <span class="st">"Feature: Text-based Logo Generation</span></span>
<span><span class="st">    As a user who calls the text_logo() function</span></span>
<span><span class="st">    I want to generate a text-based logo</span></span>
<span><span class="st">    So that I can quickly insert the pickler logo"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"pickler_logo()"</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://testthat.r-lib.org/reference/expect_snapshot.html" class="external-link">expect_snapshot</a></span><span class="op">(</span><span class="fu"><a href="../reference/pickler_logo.html">pickler_logo</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test_active_file</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>[ FAIL 1 | WARN 0 | SKIP 0 | PASS 0 ]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>── Failure (test-pickler_logo.R:8:9): pickler_logo ─────────────────────────────</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Snapshot of code has changed:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>old[6:15] vs new[6:15]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                 Y8P          888      888</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                              888      888</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        88888b.  888  .d8888b 888  888 888  .d88b.  888d888</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>-       888 "88b 888 d88P"    888 .88P 888 d8P  Y8b 888P"</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>+       888 '88b 888 d88P'    888 .88P 888 d8P  Y8b 888P'</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        888  888 888 888      888888K  888 88888888 888</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>-       888 d88P 888 Y88b.    888 "88b 888 Y8b.     888</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>+       888 d88P 888 Y88b.    888 '88b 888 Y8b.     888</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>-       88888P"  888  "Y8888P 888  888 888  "Y8888  888</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>+       88888P'  888  'Y8888P 888  888 888  'Y8888  888</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        888</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        888</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        888</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>* Run testthat::snapshot_accept('pickler_logo') to accept the change.</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>* Run testthat::snapshot_review('pickler_logo') to interactively review the change.</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>[ FAIL 1 | WARN 0 | SKIP 0 | PASS 0 ]</span></code></pre></div>
<p>This is an example of how <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> gives us the
ability to include context for tests (while keeping the scope confined
to the tests within each <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> call).</p>
</div>
<div class="section level3">
<h3 id="bdd-recap">BDD Recap<a class="anchor" aria-label="anchor" href="#bdd-recap"></a>
</h3>
<p>Multiline descriptions in the <code>desc</code> argument of
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> can cause issues when used wtth
<code><a href="https://testthat.r-lib.org/reference/expect_snapshot.html" class="external-link">expect_snapshot()</a></code>, but wrapping multiple lines in a call
to<code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> prevents the test from overwriting the
baseline snapshot file.</p>
<p>The functionality provided by <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> is an excellent
improvement to <code>testthat</code> tests, because we’re no longer
confined to comments and the <code>desc</code> argument of
<code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that()</a></code> to document what <em>exactly</em> the test is
testing.</p>
</div>
</div>
<div class="section level2">
<h2 id="rmd-bdd-pickler">Rmd + BDD = <code>pickler</code><a class="anchor" aria-label="anchor" href="#rmd-bdd-pickler"></a>
</h2>
<p>Including relevant context in <code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">describe()</a></code> and
<code><a href="https://testthat.r-lib.org/reference/describe.html" class="external-link">it()</a></code> is nice for developers, but I’ve found stakeholders
and potential users rarely look the the <code>tests/</code> folder for
information on a package’s features (or how it’s functions are supposed
to behave).</p>
<p><code>pickler</code> was written to make the information in the
<code>tests/</code> folder more accessible to a broader audience. The <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin-style</a>
functions availble in <code>pickler</code> are designed to work in R
Markdown (i.e. as a vignette) <em>and</em> run in a test file. It’s been
pointed out elsewhere<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This point in made in &lt;a href="https://engineering-shiny.org/building-ispum-app.html#rmd-vignettes-and-documentation-first" class="external-link"&gt;Engineering
Production-Grade Shiny Apps&lt;/a&gt;, and although the text is geared towards
developing a Shiny app-package, the quote is also applicable to
non-Shiny R packages.&lt;/p&gt;'><sup>3</sup></a> that vignettes have a few characteristics
that make them a great place for development:</p>
<p><br></p>
<blockquote>
<p><strong><em>“an R package implies writing documentation: one of the
main goals of the Vignettes, in an R package, is to document how to use
the package. And the good news is that when checking a package,
i.e. when running <code>check()</code> from <code>devtools</code> (<a href="https://devtools.r-lib.org/" class="external-link">Wickham, Hester, and Chang 2020</a>)
or <code>R CMD check</code>, the Vignettes are going to be built, and
the process will fail if at least one of the Vignettes fails to render.
That way, you can use the documentation of the back-end as an extra tool
for doing unit testing!”</em></strong></p>
</blockquote>
<p><br></p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Frigaard.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
